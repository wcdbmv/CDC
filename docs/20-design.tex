%% Методические указания к выполнению, оформлению и защите выпускной квалификационной работы бакалавра
%% 2.5 Конструкторский раздел
%%
%% В конструкторском разделе описывается разрабатываемый и/или модифицируемый метод или алгоритм.
%%
%% В случае если в бакалаврском проекте разрабатывается новый метод или алгоритм, необходимо подробно изложить их суть, привести всё необходимые для их реализации математические выкладки, обосновать последовательность этапов выполнения.
%% При этом для каждого этапа следует выделить необходимые исходные данные и получаемые результаты.
%%
%% При использовании известного алгоритма следует указать специфические особенности его практической реализации, присущие решаемой задаче, и пути их решения в ходе программирования.
%% Для описания метода или алгоритма необходимо выбрать наиболее подходящую форму записи (схема (ГОСТ 19.701-90), диаграмма деятельности, псевдокод и т. п.).
%% Учитывая, что на эффективность алгоритма непосредственно влияют используемые структуры данных, в данном разделе РПЗ целесообразно провести сравнительный анализ структур, которые могут быть применены в рамках программной реализации выбранного алгоритма, и обосновать выбор одной из них.
%% В конце описания разработанного и/или модифицируемого алгоритма должны быть приведены выбранные способы тестирования и сами тесты.
%%
%% Перед формированием тестовых наборов данных целесообразно указать выделенные классы эквивалентности.
%% В данной части расчётно-пояснительной записки могут также выполняться расчёты для определения объёмов памяти, необходимой для хранения данных, промежуточных и окончательных результатов работы программы, а также расчёты, позволяющие оценить время решения задачи на ЭВМ.
%% Эти результаты могут использоваться для обоснования правильности выбора метода и/или алгоритма из имеющихся альтернативных вариантов, а также для оценки возможности практически реализовать поставленную задачу на имеющейся технической базе.
%%
%% Другой важный момент, который должен найти своё отражение в конструкторском разделе, это описание структуры разрабатываемого программного обеспечения.
%% Обычно оно включает в себя:
%% — описание общей структуры — определение основных частей (компонентов) и их взаимосвязей по управлению и по данным;
%% — декомпозицию компонентов и построение структурных иерархий;
%% — проектирование компонентов.
%%
%% Для графического представления такого описания, если есть необходимость, следует использовать:
%% — функциональную модель IDEF0 с декомпозицией решения исходной задачи на несколько уровней (разрабатываемые модули обычно играют роль механизмов);
%% — спецификации компонентов (процессов);
%% — модель данных (ER-диаграмма);
%% — диаграмму классов;
%% — диаграмму компонентов;
%% — диаграмму переходов состояний (конечный автомат), характеризующих поведение системы во времени.
%%
%% Рекомендуемый объем конструкторского раздела 25—30 страниц.


\chapter{Конструкторский раздел}

%В данном разделе будут описаны используемые алгоритмы построения дерева вызовов и таблиц локальных переменных, а также метод обхода дерева разбора.

\section{Структура компилятора}
Концептуальная модель разрабатываемого компилятора в нотации IDEF0 представлена на рисунке \ref{img:idef0-A0}.

\imgH{scale=1.0}{idef0-A0}{Концептуальная модель в нотации IDEF0}

На рисунке \ref{img:idef0-A1-2} представлена детализированная концептуальная модель в нотации IDEF0.
ANTLR фронтенд получает на вход исходный код программы и генерирует конкретное синтаксическое дерево, на основе которого компилятором генерируется LLVM IR.

\imgH{scale=1.0}{idef0-A1-2}{Детализированная концептуальная модель в нотации IDEF0}

\section{Метод обхода AST}

Для обхода абстрактного синтаксического дерева, которое строит ANTLR, использовался паттерн слушатель.
ANTLR генерирует интерфейс слушателя, который реагирует на события, запускаемые встроенным классом для обхода дерева.
Методы в слушателе — это просто обратные вызовы, которые вызываются при вхождении в некоторую вершину дерева при обходе (enter-методы) и при выходе (exit-методы) [4].

ANTLR генерирует интерфейс слушателя специфичный для заданной грамматики и содержащий exit- и enter-методы для каждого правила, которые нужно реализовать в зависимости от решаемой задачи.
На рисунках \ref{img:listener} и \ref{img:walker} представлен порядок обхода дерева средствами ANTLR и порядок вызовов коллбэк-методов класса слушателя.

\imgH{width=\linewidth}{listener}{Порядок обхода дерева разбора}

\imgH{width=\linewidth}{walker}{Порядок вызова методов слушателя}

\section{Генерация LLVM IR}

Для генерации кода LLVM IR необходимо произвести обход дерева разбора, полученного из парсера ANTLR, и в каждой вершине произвести генерацию соответствующую её типу.

Схема алгоритма для генерации кода LLVM IR для цикла for с выражениями, выполняющимися до входа в цикл и после выполнения тела цикла, приведена на рисунках 4 и 5.

\imgH{scale=0.58}{for-before}{Схема генерации кода для выражения инициализации и условного выражения цикла for}

\imgH{scale=0.66}{for-after}{Схема генерации кода для тела и выражения, выполняющегося после тела цикла for}


%\section{Выводы}
